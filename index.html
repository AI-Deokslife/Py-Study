<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì½”ì¹­ ê¸°ë°˜ íŒŒì´ì¬ í•™ìŠµ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- highlight.js for code syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <!-- marked.js for rendering Markdown from AI -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- API ì„¤ì • íŒŒì¼ -->
    <script src="config.js"></script>
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .step-card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .step-number {
            background-color: #10B981;
            color: white;
            border-radius: 9999px;
            width: 2rem;
            height: 2rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-right: 0.75rem;
            flex-shrink: 0;
        }
        #user-code-input {
            font-family: 'Courier New', Courier, monospace;
            line-height: 1.5;
            background-color: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1rem;
            min-height: 200px;
            width: 100%;
            outline: none;
            transition: border-color 0.2s;
        }
        #user-code-input:focus {
            border-color: #10B981;
            box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.2);
        }
        /* Markdown styling */
        .markdown-content ul { list-style-type: disc; margin-left: 1.5rem; }
        .markdown-content p { margin-bottom: 0.5rem; }
        .markdown-content strong { font-weight: 700; }
        .markdown-content h4 { font-weight: 700; font-size: 1.125rem; margin-top: 1rem; margin-bottom: 0.5rem; border-bottom: 1px solid #e5e7eb; padding-bottom: 0.25rem;}
        .markdown-content code { background-color: #e2e8f0; padding: 0.2rem 0.4rem; border-radius: 0.25rem; font-size: 0.9em;}
        .markdown-content pre { 
            margin-bottom: 1rem; 
            background-color: #1f2937; 
            color: #f9fafb;
            padding: 1.5rem; 
            border-radius: 0.5rem; 
            font-family: 'Courier New', 'Monaco', 'Consolas', monospace;
            font-size: 1.1em;
            line-height: 1.4;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-x: hidden;
            border: 2px solid #374151;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .markdown-content pre code {
            background-color: transparent;
            padding: 0;
            font-family: inherit;
        }
        
        /* ëª¨ë‹¬ ë‚´ ë§ˆí¬ë‹¤ìš´ ìŠ¤íƒ€ì¼ ê°œì„  */
        .prose {
            line-height: 1.7;
            font-size: 1rem;
            color: #374151;
        }
        .prose h1, .prose h2, .prose h3, .prose h4 {
            color: #1e40af;
            font-weight: 700;
            margin-top: 2rem;
            margin-bottom: 0.75rem;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 0.5rem;
        }
        .prose h1 { 
            font-size: 1.75rem; 
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .prose h2 { 
            font-size: 1.5rem; 
            color: #1e40af;
        }
        .prose h3 { 
            font-size: 1.25rem; 
            color: #2563eb;
        }
        .prose h4 { 
            font-size: 1.125rem; 
            color: #3b82f6;
        }
        .prose p {
            margin-bottom: 1.25rem;
            text-align: justify;
        }
        .prose ul, .prose ol {
            margin-left: 1.75rem;
            margin-bottom: 1.25rem;
        }
        .prose li {
            margin-bottom: 0.75rem;
            line-height: 1.6;
        }
        .prose strong {
            font-weight: 700;
            color: #1e40af;
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
        }
        .prose code {
            background: #f1f5f9;
            color: #dc2626;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.9em;
            font-weight: 600;
            border: 1px solid #e2e8f0;
        }
        .prose pre {
            background: #1e293b !important;
            color: #f8fafc !important;
            padding: 1.5rem;
            border-radius: 0.75rem;
            overflow-x: hidden;
            margin: 1.5rem 0;
            border: 2px solid #475569;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .prose pre code {
            background-color: transparent !important;
            color: #f8fafc !important;
            padding: 0;
            border: none;
            font-weight: 400;
            font-family: 'Courier New', 'Monaco', 'Consolas', monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .prose blockquote {
            border-left: 4px solid #3b82f6;
            background: linear-gradient(135deg, #eff6ff, #dbeafe);
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0.5rem;
            font-style: italic;
            color: #1e40af;
        }

        #custom-topic-input:disabled {
            background-color: #f3f4f6;
            cursor: not-allowed;
        }
        
        .difficulty-radio:checked + label {
            background-color: #10B981;
            color: white;
            border-color: #10B981;
        }
        .difficulty-radio[value="ë¦¬íŒ©í† ë§ ì±Œë¦°ì§€"]:checked + label {
            background-color: #8b5cf6; /* Violet for refactoring */
            border-color: #8b5cf6;
        }

        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border-left-color: #10B981;
            animation: spin 1s ease infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="w-full max-w-4xl mx-auto p-4 sm:p-6 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-900">AI ì½”ì¹­ ê¸°ë°˜ íŒŒì´ì¬ í•™ìŠµ</h1>
            <p class="text-gray-600 mt-2">AI íŠœí„°ì˜ ë„ì›€ì„ ë°›ì•„ íŒŒì´ì¬ ë¬¸ì œë¥¼ í•´ê²°í•´ ë³´ì„¸ìš”.</p>
        </header>

        <!-- Step 1: ë¬¸ì œ ìƒì„±ê¸° -->
        <div class="step-card">
            <div class="flex items-center mb-4">
                <span class="step-number">1</span>
                <h2 class="text-2xl font-bold">ë¬¸ì œ ìƒì„±ê¸°</h2>
            </div>

            <div class="mb-6">
                <h4 class="font-semibold text-gray-700 mb-3">ë‚œì´ë„ë¥¼ ì„ íƒí•˜ì„¸ìš”</h4>
                <div id="difficulty-selection" class="grid grid-cols-2 sm:grid-cols-4 gap-3">
                    <div>
                        <input type="radio" id="level-beginner" name="difficulty" value="ì´ˆê¸‰" class="hidden difficulty-radio" checked>
                        <label for="level-beginner" class="block text-center cursor-pointer p-3 border rounded-lg transition-colors">ì´ˆê¸‰</label>
                    </div>
                    <div>
                        <input type="radio" id="level-intermediate" name="difficulty" value="ì¤‘ê¸‰" class="hidden difficulty-radio">
                        <label for="level-intermediate" class="block text-center cursor-pointer p-3 border rounded-lg transition-colors">ì¤‘ê¸‰</label>
                    </div>
                    <div>
                        <input type="radio" id="level-advanced" name="difficulty" value="ê³ ê¸‰" class="hidden difficulty-radio">
                        <label for="level-advanced" class="block text-center cursor-pointer p-3 border rounded-lg transition-colors">ê³ ê¸‰</label>
                    </div>
                    <div>
                        <input type="radio" id="level-contest" name="difficulty" value="ë¦¬íŒ©í† ë§ ì±Œë¦°ì§€" class="hidden difficulty-radio">
                        <label for="level-contest" class="block text-center cursor-pointer p-3 border rounded-lg transition-colors">ë¦¬íŒ©í† ë§ ì±Œë¦°ì§€</label>
                    </div>
                </div>
            </div>

            <div class="mb-4">
                <h4 class="font-semibold text-gray-700 mb-2">í•™ìŠµí•  ì£¼ì œë¥¼ ì„ íƒí•˜ì„¸ìš” (í•˜ë‚˜ ì´ìƒ)</h4>
                <div id="topic-selection" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
                    <!-- Checkboxes will be dynamically generated here -->
                </div>
                 <div class="flex items-center mt-4 col-span-full">
                    <input id="cat-etc" type="checkbox" value="ê¸°íƒ€" class="h-4 w-4 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                    <label for="cat-etc" class="sr-only">ê¸°íƒ€</label>
                    <input id="custom-topic-input" type="text" placeholder="ê¸°íƒ€ (ì²´í¬ í›„ ì§ì ‘ ì£¼ì œ ì…ë ¥)" class="ml-2 flex-grow p-2 border border-gray-300 rounded-md text-sm" disabled>
                </div>
            </div>
            <button id="generate-quiz-btn" class="w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-3 px-4 rounded-lg transition duration-300 flex items-center justify-center">
                 <span id="generate-btn-text">AIë¡œ ë¬¸ì œ ìƒì„±í•˜ê¸°</span>
                 <div id="generate-spinner" class="spinner hidden ml-2"></div>
            </button>
        </div>

        <!-- ë¬¸ì œ í’€ì´ ì„¹ì…˜ (ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€) -->
        <div id="project-section" class="hidden">
            <!-- Step 2: ìƒì„±ëœ ë¬¸ì œ -->
            <div class="step-card">
                <div class="flex items-center mb-4">
                    <span class="step-number">2</span>
                    <h2 id="quiz-title" class="text-2xl font-bold"></h2>
                </div>
                <div id="quiz-description" class="text-gray-700 markdown-content"></div>
            </div>

            <!-- Step 3: ì½”ë“œ ë‹µì•ˆ ì…ë ¥ -->
            <div class="step-card">
                <div class="flex items-center mb-4">
                    <span class="step-number">3</span>
                    <h2 class="text-2xl font-bold">ì½”ë“œ ë‹µì•ˆ ì…ë ¥</h2>
                </div>
                <p id="code-input-guide" class="text-gray-600 mb-4"></p>
                <textarea id="user-code-input" placeholder="# íŒŒì´ì¬ ì½”ë“œë¥¼ ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš”."></textarea>
                <div class="flex flex-wrap gap-2 mt-4">
                    <button id="ai-coach-btn" class="w-full sm:w-auto flex-grow bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-6 rounded-lg transition duration-300 flex items-center justify-center">
                        <span id="coach-btn-text">AI ì½”ì¹­ ë°›ê¸°</span>
                        <div id="coach-spinner" class="spinner hidden ml-2"></div>
                    </button>
                    <button id="optimize-code-btn" class="w-full sm:w-auto flex-grow bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-6 rounded-lg transition duration-300 flex items-center justify-center">
                        <span id="optimize-btn-text">âœ¨ AI ì½”ë“œ ìµœì í™” ì œì•ˆ</span>
                        <div id="optimize-spinner" class="spinner hidden ml-2"></div>
                    </button>
                </div>
                <div id="ai-feedback" class="mt-4 bg-sky-50 p-4 rounded-lg border border-sky-200 text-sky-800 hidden markdown-content"></div>
            </div>

            <!-- Step 4: ëª¨ë²” ì½”ë“œ ë‹µì•ˆ -->
            <div class="step-card">
                <div class="flex items-center mb-4">
                    <span class="step-number">4</span>
                    <h2 class="text-2xl font-bold">ëª¨ë²” ì½”ë“œ ë‹µì•ˆ</h2>
                </div>
                 <p class="text-gray-600 mb-4">ë¬¸ì œ í•´ê²°ì´ ëë‚¬ê±°ë‚˜, ì •ë‹µì´ ê¶ê¸ˆí•˜ë‹¤ë©´ ëª¨ë²” ë‹µì•ˆì„ í™•ì¸í•´ ë³´ì„¸ìš”.</p>
                <button id="show-answer-btn" class="w-full md:w-auto bg-gray-700 hover:bg-gray-800 text-white font-bold py-2 px-6 rounded-lg transition duration-300 mb-4">
                    ëª¨ë²” ë‹µì•ˆ ë³´ê¸°
                </button>
                <div id="answer-container" class="hidden space-y-6">
                    <!-- ì´ˆë³´ììš© í’€ì´ -->
                    <div class="bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl p-6 shadow-sm">
                        <div class="flex justify-between items-center mb-4">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-green-500 text-white rounded-full flex items-center justify-center mr-3 text-lg font-bold">
                                    ğŸ§‘â€ğŸ’»
                                </div>
                                <h4 id="beginner-answer-title" class="text-xl font-bold text-green-800"></h4>
                            </div>
                            <button id="explain-beginner-btn" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-200 shadow-sm flex items-center gap-2">
                                <span>âœ¨</span>
                                <span>ì„¤ëª… ë³´ê¸°</span>
                            </button>
                        </div>
                        <div class="bg-white rounded-lg p-4 border border-green-100 shadow-sm">
                            <pre style="white-space: pre-wrap; word-wrap: break-word; overflow-x: hidden;"><code id="answer-code-beginner" class="language-python"></code></pre>
                        </div>
                        <div id="explanation-beginner" class="mt-4 p-4 bg-green-50 rounded-lg border border-green-200 hidden markdown-content"></div>
                    </div>
                    
                    <!-- ìˆ™ë ¨ììš© í’€ì´ -->
                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 shadow-sm">
                        <div class="flex justify-between items-center mb-4">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-blue-500 text-white rounded-full flex items-center justify-center mr-3 text-lg font-bold">
                                    ğŸš€
                                </div>
                                <h4 id="expert-answer-title" class="text-xl font-bold text-blue-800"></h4>
                            </div>
                            <button id="explain-expert-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-200 shadow-sm flex items-center gap-2">
                                <span>âœ¨</span>
                                <span>ì„¤ëª… ë³´ê¸°</span>
                            </button>
                        </div>
                        <div class="bg-white rounded-lg p-4 border border-blue-100 shadow-sm">
                            <pre style="white-space: pre-wrap; word-wrap: break-word; overflow-x: hidden;"><code id="answer-code-expert" class="language-python"></code></pre>
                        </div>
                        <div id="explanation-expert" class="mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200 hidden markdown-content"></div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="text-center mt-8 text-sm text-gray-500">
            <p>&copy; 2025 Interactive Python Learning. Created by Lee Eun Deok. All rights reserved.</p>
        </footer>
    </div>

    <!-- Custom Modal for Alerts -->
    <div id="alert-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl p-6 w-11/12 max-w-sm text-center">
            <p id="alert-message" class="mb-4 text-lg"></p>
            <button id="alert-close-btn" class="bg-emerald-500 text-white px-6 py-2 rounded-lg">í™•ì¸</button>
        </div>
    </div>

    <!-- Code Explanation Modal -->
    <div id="explanation-modal" class="fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center z-50 hidden p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden">
            <!-- Modal Header -->
            <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-6 flex items-center justify-between">
                <h3 id="explanation-modal-title" class="text-xl font-bold">ì½”ë“œ ì„¤ëª…</h3>
                <button id="explanation-modal-close" class="text-white hover:text-gray-200 text-2xl font-bold w-8 h-8 flex items-center justify-center rounded-full hover:bg-white hover:bg-opacity-20 transition-colors">
                    Ã—
                </button>
            </div>
            
            <!-- Modal Body -->
            <div class="p-6 overflow-y-auto max-h-[calc(90vh-120px)]">
                <div id="explanation-modal-content" class="markdown-content prose max-w-none">
                    <div class="flex items-center justify-center py-8">
                        <div class="spinner mr-3"></div>
                        <span>AIê°€ ì½”ë“œë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- ì´ˆê¸° ì„¤ì • í™•ì¸ ---
        console.log("=== ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™” ===");
        console.log("APP_CONFIG ìƒíƒœ:", window.APP_CONFIG);
        if (window.APP_CONFIG) {
            console.log("Netlify Functions API URL:", window.APP_CONFIG.GEMINI_API_URL);
        } else {
            console.error("âŒ APP_CONFIGê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤! config.js íŒŒì¼ì„ í™•ì¸í•˜ì„¸ìš”.");
        }
        
        // --- DOM ìš”ì†Œ ---
        const projectSection = document.getElementById('project-section');
        const generateQuizBtn = document.getElementById('generate-quiz-btn');
        const generateBtnText = document.getElementById('generate-btn-text');
        const generateSpinner = document.getElementById('generate-spinner');
        const topicSelectionContainer = document.getElementById('topic-selection');
        const etcCheckbox = document.getElementById('cat-etc');
        const customTopicInput = document.getElementById('custom-topic-input');
        const quizTitle = document.getElementById('quiz-title');
        const quizDescription = document.getElementById('quiz-description');
        const codeInputGuide = document.getElementById('code-input-guide');
        const userCodeInput = document.getElementById('user-code-input');
        const aiCoachBtn = document.getElementById('ai-coach-btn');
        const coachBtnText = document.getElementById('coach-btn-text');
        const coachSpinner = document.getElementById('coach-spinner');
        const optimizeCodeBtn = document.getElementById('optimize-code-btn');
        const optimizeBtnText = document.getElementById('optimize-btn-text');
        const optimizeSpinner = document.getElementById('optimize-spinner');
        const aiFeedback = document.getElementById('ai-feedback');
        const showAnswerBtn = document.getElementById('show-answer-btn');
        const answerContainer = document.getElementById('answer-container');
        const beginnerAnswerTitle = document.getElementById('beginner-answer-title');
        const expertAnswerTitle = document.getElementById('expert-answer-title');
        const answerCodeBeginner = document.getElementById('answer-code-beginner');
        const answerCodeExpert = document.getElementById('answer-code-expert');
        const explainBeginnerBtn = document.getElementById('explain-beginner-btn');
        const explainExpertBtn = document.getElementById('explain-expert-btn');
        const explanationBeginner = document.getElementById('explanation-beginner');
        const explanationExpert = document.getElementById('explanation-expert');
        const alertModal = document.getElementById('alert-modal');
        const alertMessage = document.getElementById('alert-message');
        const alertCloseBtn = document.getElementById('alert-close-btn');
        
        // ì„¤ëª… ëª¨ë‹¬ ìš”ì†Œë“¤
        const explanationModal = document.getElementById('explanation-modal');
        const explanationModalTitle = document.getElementById('explanation-modal-title');
        const explanationModalContent = document.getElementById('explanation-modal-content');
        const explanationModalClose = document.getElementById('explanation-modal-close');
        
        let currentQuiz = null;

        // --- í•¨ìˆ˜ ---
        
        // ì»¤ìŠ¤í…€ ì•Œë¦¼ì°½ í‘œì‹œ
        function showAlert(message) {
            alertMessage.textContent = message;
            alertModal.classList.remove('hidden');
        }
        alertCloseBtn.addEventListener('click', () => alertModal.classList.add('hidden'));

        // ì„¤ëª… ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function showExplanationModal(title, isLoading = true, type = 'default') {
            explanationModalTitle.textContent = title;
            
            // íƒ€ì…ë³„ ìƒ‰ìƒ ì„¤ì •
            const colors = {
                beginner: {
                    primary: '#10b981',
                    secondary: '#065f46',
                    bg: 'from-green-500 to-emerald-600',
                    spinner: 'border-green-200 border-t-green-500',
                    dots: 'bg-green-400'
                },
                expert: {
                    primary: '#3b82f6',
                    secondary: '#1e3a8a',
                    bg: 'from-blue-500 to-indigo-600',
                    spinner: 'border-blue-200 border-t-blue-500',
                    dots: 'bg-blue-400'
                },
                default: {
                    primary: '#6366f1',
                    secondary: '#4338ca',
                    bg: 'from-blue-500 to-purple-600',
                    spinner: 'border-blue-200 border-t-blue-500',
                    dots: 'bg-blue-400'
                }
            };
            
            const color = colors[type] || colors.default;
            
            // í—¤ë” ìƒ‰ìƒ ì—…ë°ì´íŠ¸
            const modalHeader = explanationModal.querySelector('.bg-gradient-to-r');
            modalHeader.className = `bg-gradient-to-r ${color.bg} text-white p-6 flex items-center justify-between`;
            
            if (isLoading) {
                explanationModalContent.innerHTML = `
                    <div class="flex flex-col items-center justify-center py-12 px-6">
                        <div class="relative mb-6">
                            <div class="w-16 h-16 border-4 ${color.spinner} rounded-full animate-spin"></div>
                            <div class="absolute inset-0 flex items-center justify-center">
                                <div class="w-8 h-8 rounded-full opacity-20" style="background-color: ${color.primary};"></div>
                            </div>
                        </div>
                        <div class="text-center">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">âœ¨ AIê°€ ì½”ë“œë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤</h4>
                            <p class="text-gray-600 text-sm">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”. ê³§ ìì„¸í•œ ì„¤ëª…ì„ ì œê³µí•´ë“œë¦´ê²Œìš”!</p>
                        </div>
                        <div class="mt-6 flex space-x-1">
                            <div class="w-2 h-2 ${color.dots} rounded-full animate-bounce" style="animation-delay: 0ms;"></div>
                            <div class="w-2 h-2 ${color.dots} rounded-full animate-bounce" style="animation-delay: 150ms;"></div>
                            <div class="w-2 h-2 ${color.dots} rounded-full animate-bounce" style="animation-delay: 300ms;"></div>
                        </div>
                    </div>
                `;
            }
            explanationModal.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // ìŠ¤í¬ë¡¤ ë°©ì§€
        }
        
        function hideExplanationModal() {
            explanationModal.classList.add('hidden');
            document.body.style.overflow = 'auto'; // ìŠ¤í¬ë¡¤ ë³µì›
        }
        
        function setExplanationContent(content, type = 'default') {
            const parsedContent = marked.parse(content, { 
                sanitize: false,
                gfm: true,
                breaks: true
            });
            
            // íƒ€ì…ë³„ ë°°ê²½ ìƒ‰ìƒ ì„¤ì •
            const bgColors = {
                beginner: 'bg-gradient-to-br from-green-50 to-emerald-50 border-green-100',
                expert: 'bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-100', 
                default: 'bg-gradient-to-br from-purple-50 to-indigo-50 border-purple-100'
            };
            
            const bgClass = bgColors[type] || bgColors.default;
            
            explanationModalContent.innerHTML = `
                <div class="${bgClass} rounded-xl p-6 border shadow-sm">
                    <div class="prose prose-blue max-w-none">
                        ${parsedContent}
                    </div>
                </div>
            `;
        }
        
        // ëª¨ë‹¬ ë‹«ê¸° ì´ë²¤íŠ¸
        explanationModalClose.addEventListener('click', hideExplanationModal);
        explanationModal.addEventListener('click', (e) => {
            if (e.target === explanationModal) {
                hideExplanationModal();
            }
        });
        
        // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                hideExplanationModal();
            }
        });

        // ì£¼ì œ ì„ íƒ ì²´í¬ë°•ìŠ¤ ë™ì  ìƒì„±
        function populateTopics() {
            const categories = ['ì…ì¶œë ¥', 'ë³€ìˆ˜ì™€ ì—°ì‚°', 'ì¡°ê±´ë¬¸', 'ë°˜ë³µë¬¸', 'ë¦¬ìŠ¤íŠ¸', 'ë¬¸ìì—´', 'í•¨ìˆ˜', 'ë”•ì…”ë„ˆë¦¬', 'íŒŒì¼ ì²˜ë¦¬'];
            topicSelectionContainer.innerHTML = categories.map(cat => `
                <div class="flex items-center">
                    <input id="cat-${cat}" type="checkbox" value="${cat}" class="h-4 w-4 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                    <label for="cat-${cat}" class="ml-2 block text-sm text-gray-900">${cat}</label>
                </div>
            `).join('');
        }

        // ìƒˆë¡œìš´ ë¬¸ì œ ìƒì„± UI ì—…ë°ì´íŠ¸
        function updateUIWithNewQuiz(quiz) {
            currentQuiz = quiz;
            quizTitle.textContent = quiz.title;
            
            const cleanedDescription = quiz.description.replace(/\u00A0/g, ' ');
            
            if(quiz.inefficient_code) { // ë¦¬íŒ©í† ë§ ì±Œë¦°ì§€ì¸ ê²½ìš°
                quizDescription.innerHTML = marked.parse(cleanedDescription, { sanitize: false }) + 
                '<h4>ê°œì„ í•  ì½”ë“œ ğŸ‘‡</h4><pre><code class="language-python">' + quiz.inefficient_code + '</code></pre>';
                quizDescription.querySelectorAll('pre code').forEach(block => hljs.highlightElement(block));
                codeInputGuide.textContent = "ìœ„ì— ì œì‹œëœ 'ê°œì„ í•  ì½”ë“œ'ë¥¼ ë” íš¨ìœ¨ì ì´ê³  ì½ê¸° ì‰½ê²Œ ë¦¬íŒ©í† ë§í•˜ì—¬ ì•„ë˜ì— ì‘ì„±í•´ ë³´ì„¸ìš”.";
            } else { // ì¼ë°˜ ë¬¸ì œì¸ ê²½ìš°
                // HTML íƒœê·¸ë¥¼ í—ˆìš©í•˜ë„ë¡ marked ì„¤ì •
                quizDescription.innerHTML = marked.parse(cleanedDescription, { 
                    sanitize: false,
                    gfm: true,
                    breaks: true
                });
                codeInputGuide.textContent = "ìƒì„±ëœ ë¬¸ì œì— ëŒ€í•œ ë‹µì•ˆ ì½”ë“œë¥¼ ì‘ì„±í•´ ë³´ì„¸ìš”. ë§‰íˆëŠ” ë¶€ë¶„ì´ ìˆë‹¤ë©´ AI ì½”ì¹­ì„ ë°›ì•„ë³´ì„¸ìš”.";
            }
            
            projectSection.classList.remove('hidden');
            
            userCodeInput.value = '';
            aiFeedback.classList.add('hidden');
            aiFeedback.innerHTML = '';
            answerContainer.classList.add('hidden');
            showAnswerBtn.textContent = "ëª¨ë²” ë‹µì•ˆ ë³´ê¸°";
            explanationBeginner.classList.add('hidden');
            explanationExpert.classList.add('hidden');
        }
        
        // AIì—ê²Œ ë¬¸ì œ ìƒì„± ìš”ì²­
        async function fetchAIQuiz(topics, difficulty) {
            console.log("=== fetchAIQuiz í•¨ìˆ˜ ì‹œì‘ ===");
            console.log("ì „ë‹¬ë°›ì€ topics:", topics);
            console.log("ì „ë‹¬ë°›ì€ difficulty:", difficulty);
            
            generateBtnText.textContent = "AIê°€ ë¬¸ì œë¥¼ ë§Œë“œëŠ” ì¤‘...";
            generateSpinner.classList.remove('hidden');
            generateQuizBtn.disabled = true;

            let prompt;
            if (difficulty === 'ë¦¬íŒ©í† ë§ ì±Œë¦°ì§€') {
                prompt = `íŒŒì´ì¬ ì½”ë“œ ë¦¬íŒ©í† ë§ ì±Œë¦°ì§€ ë¬¸ì œë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”. ì£¼ì œ: ${topics.join(', ')}

ë‹¤ìŒ ìš”ì†Œë“¤ì„ í¬í•¨í•´ì£¼ì„¸ìš”:
1. ì½”ë“œì˜ ëª©ì ì„ ì„¤ëª…í•˜ëŠ” ë¬¸ì œ ì„¤ëª…
2. ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•˜ì§€ë§Œ ë¹„íš¨ìœ¨ì ì¸ ì½”ë“œ (ëŠë¦¬ê±°ë‚˜ ì½ê¸° ì–´ë µê±°ë‚˜ íŒŒì´ì¬ë‹µì§€ ì•Šì€ ì½”ë“œ)
3. ê°œì„ ëœ íš¨ìœ¨ì ì´ê³  íŒŒì´ì¬ë‹¤ìš´ í•´ê²°ì±…

ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œë§Œ ì‘ë‹µí•´ì£¼ì„¸ìš”:
{"id": "ê³ ìœ _ì•„ì´ë””", "category": "${topics[0]}", "title": "ë¦¬íŒ©í† ë§ ì±Œë¦°ì§€: ì œëª©", "description": "ë§ˆí¬ë‹¤ìš´ìœ¼ë¡œ ì‘ì„±ëœ ë¬¸ì œ ì„¤ëª…", "inefficient_code": "ë¹„íš¨ìœ¨ì ì¸ íŒŒì´ì¬ ì½”ë“œ", "refactored_code": "ê°œì„ ëœ íŒŒì´ì¬ ì½”ë“œ"}

ì¤‘ìš”ì‚¬í•­:
- ëª¨ë“  í…ìŠ¤íŠ¸ëŠ” í•œê¸€ë¡œ ì‘ì„±
- JSON ë¬¸ìì—´ì—ì„œ ì¤„ë°”ê¿ˆì€ \\nìœ¼ë¡œ ì´ìŠ¤ì¼€ì´í”„
- descriptionì—ëŠ” ë§ˆí¬ë‹¤ìš´ í˜•ì‹ ì‚¬ìš©`;
            } else {
                // ëœë¤ ìš”ì†Œë“¤ ìƒì„±
                const randomSeed = Date.now() + Math.random();
                const contexts = ['ê²Œì„', 'ìŒì‹', 'ì—¬í–‰', 'ì‡¼í•‘', 'í•™êµ', 'íšŒì‚¬', 'ë³‘ì›', 'ì€í–‰', 'ë„ì„œê´€', 'ì¹´í˜', 'ì˜í™”ê´€', 'ê³µì›', 'í—¬ìŠ¤ì¥', 'ë¯¸ìš©ì‹¤', 'ì„œì ', 'ë§ˆíŠ¸', 'í¸ì˜ì ', 'ì£¼ì‹', 'ì•”í˜¸í™”í', 'ë‚ ì”¨', 'êµí†µ', 'ë¶€ë™ì‚°', 'ìŠ¤í¬ì¸ ', 'ìŒì•…', 'ì˜ˆìˆ ', 'ìš”ë¦¬', 'íŒ¨ì…˜', 'ê±´ê°•', 'ì·¨ë¯¸'];
                const scenarios = ['ê´€ë¦¬ ì‹œìŠ¤í…œ', 'ê³„ì‚°ê¸°', 'ë¶„ì„ ë„êµ¬', 'ì¶”ì²œ ì‹œìŠ¤í…œ', 'ê²Œì„', 'ì‹œë®¬ë ˆì´í„°', 'ë³€í™˜ê¸°', 'ê²€ìƒ‰ ì—”ì§„', 'ì±—ë´‡', 'í”Œë˜ë„ˆ', 'íŠ¸ë˜ì»¤', 'ëª¨ë‹ˆí„°ë§ ë„êµ¬', 'ì˜ˆì¸¡ê¸°', 'ìƒì„±ê¸°', 'ìµœì í™” ë„êµ¬'];
                const dataTypes = ['ì ìˆ˜', 'ê°€ê²©', 'ì‹œê°„', 'ê±°ë¦¬', 'ì˜¨ë„', 'ì¸ì›ìˆ˜', 'ìˆœìœ„', 'í‰ì ', 'ìˆ˜ëŸ‰', 'ë¹„ìœ¨', 'í™•ë¥ ', 'ì†ë„', 'í¬ê¸°', 'ë¬´ê²Œ', 'ë‚˜ì´'];
                
                const randomContext = contexts[Math.floor(Math.random() * contexts.length)];
                const randomScenario = scenarios[Math.floor(Math.random() * scenarios.length)];
                const randomDataType = dataTypes[Math.floor(Math.random() * dataTypes.length)];
                
                // ì£¼ì œë³„ íŠ¹í™” ë°©í–¥ì„± (ì£¼ì œì—ë§Œ ì§‘ì¤‘)
                const topicDirections = {
                    'ì…ì¶œë ¥': ['ì…ë ¥ ê²€ì¦', 'í˜•ì‹ ë³€í™˜', 'ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤', 'ë°ì´í„° ìˆ˜ì§‘', 'ê²°ê³¼ í‘œì‹œ', 'í¬ë§·íŒ…'],
                    'ë³€ìˆ˜ì™€ ì—°ì‚°': ['ë³€ìˆ˜ ì„ ì–¸', 'ë°ì´í„° íƒ€ì…', 'ì‚°ìˆ  ì—°ì‚°', 'ë…¼ë¦¬ ì—°ì‚°', 'ë³€ìˆ˜ í™œìš©'],
                    'ì¡°ê±´ë¬¸': ['ì¡°ê±´ íŒë‹¨', 'ë¶„ê¸° ì²˜ë¦¬', 'ìƒíƒœ í™•ì¸', 'ì¡°ê±´ë¶€ ì‹¤í–‰', 'ë…¼ë¦¬ ì—°ì‚°'],
                    'ë°˜ë³µë¬¸': ['ë°˜ë³µ ì‹¤í–‰', 'ìˆœí™˜ ì²˜ë¦¬', 'ë°˜ë³µ ì œì–´', 'ë£¨í”„ í™œìš©', 'ë°˜ë³µ íŒ¨í„´'],
                    'ë¦¬ìŠ¤íŠ¸': ['ë¦¬ìŠ¤íŠ¸ ì¡°ì‘', 'ë°ì´í„° ì €ì¥', 'ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬', 'ìš”ì†Œ ì²˜ë¦¬', 'ë¦¬ìŠ¤íŠ¸ ì—°ì‚°'],
                    'ë¬¸ìì—´': ['ë¬¸ìì—´ ì²˜ë¦¬', 'í…ìŠ¤íŠ¸ ì¡°ì‘', 'ë¬¸ìì—´ ë¶„ì„', 'í…ìŠ¤íŠ¸ ë³€í™˜', 'ë¬¸ìì—´ ì—°ì‚°'],
                    'í•¨ìˆ˜': ['í•¨ìˆ˜ ì •ì˜', 'ì½”ë“œ ëª¨ë“ˆí™”', 'í•¨ìˆ˜ í˜¸ì¶œ', 'ë§¤ê°œë³€ìˆ˜ í™œìš©', 'ë°˜í™˜ê°’ ì²˜ë¦¬'],
                    'ë”•ì…”ë„ˆë¦¬': ['ë”•ì…”ë„ˆë¦¬ ì¡°ì‘', 'í‚¤-ê°’ ê´€ë¦¬', 'ë°ì´í„° êµ¬ì¡°', 'í•´ì‹œ í…Œì´ë¸”', 'ë”•ì…”ë„ˆë¦¬ ì—°ì‚°'],
                    'íŒŒì¼ ì²˜ë¦¬': ['íŒŒì¼ ì½ê¸°', 'íŒŒì¼ ì“°ê¸°', 'íŒŒì¼ ê´€ë¦¬', 'ë°ì´í„° ì €ì¥', 'íŒŒì¼ ì‹œìŠ¤í…œ']
                };
                
                const mainTopic = topics[0];
                const directions = topicDirections[mainTopic] || ['ì¼ë°˜ì ì¸ í”„ë¡œê·¸ë˜ë°'];
                const randomDirection = directions[Math.floor(Math.random() * directions.length)];
                
                // íŒŒì´ì¬ í•™ìŠµ ë‹¨ê³„ë³„ ìœ„ê³„ ì •ì˜
                const learningHierarchy = ['ì…ì¶œë ¥', 'ë³€ìˆ˜ì™€ ì—°ì‚°', 'ì¡°ê±´ë¬¸', 'ë°˜ë³µë¬¸', 'ë¦¬ìŠ¤íŠ¸', 'ë¬¸ìì—´', 'í•¨ìˆ˜', 'ë”•ì…”ë„ˆë¦¬', 'íŒŒì¼ ì²˜ë¦¬'];
                const selectedTopicIndices = topics.map(topic => learningHierarchy.indexOf(topic)).filter(index => index !== -1);
                const maxTopicLevel = Math.max(...selectedTopicIndices);
                const allowedConcepts = learningHierarchy.slice(0, maxTopicLevel + 1);
                
                // ë‚œì´ë„ë³„ ì„¸ë¶€ ì •ì˜
                const difficultySpecs = {
                    'ì´ˆê¸‰': {
                        description: 'íŒŒì´ì¬ ì…ë¬¸ì ìˆ˜ì¤€ (ì²˜ìŒ íŒŒì´ì¬ì„ ì ‘í•˜ë©° ê¸°ë³¸ ë¬¸ë²•ì„ ë°°ìš°ëŠ” ë‹¨ê³„)',
                        complexity: 'ë§¤ìš° ë‹¨ìˆœí•œ ë¡œì§, ê¸°ë³¸ ë¬¸ë²•ë§Œ ì‚¬ìš©',
                        concepts: 'ì„ íƒëœ ì£¼ì œì˜ ê°€ì¥ ê¸°ë³¸ì ì¸ ê°œë…ë§Œ',
                        variables: 'ë‹¨ìˆœí•˜ê³  ì§ê´€ì ì¸ ë³€ìˆ˜ëª…',
                        logic: 'í•œë²ˆì— í•˜ë‚˜ì˜ ê°œë…ë§Œ ë‹¤ë£¨ëŠ” ë‹¨ìˆœí•œ ë¬¸ì œ'
                    },
                    'ì¤‘ê¸‰': {
                        description: 'íŒŒì´ì¬ êµì¬ 1~3íšŒë… ìˆ˜ì¤€ (ê¸°ë³¸ ë¬¸ë²•ì„ ì´í•´í•˜ê³  ì‘ìš©í•  ìˆ˜ ìˆëŠ” ë‹¨ê³„)',
                        complexity: 'ì—¬ëŸ¬ ê°œë…ì„ ì¡°í•©í•œ ë¡œì§, ì¤‘ê°„ ìˆ˜ì¤€ì˜ ë¬¸ì œ í•´ê²°',
                        concepts: 'ì„ íƒëœ ì£¼ì œì˜ í•µì‹¬ ê¸°ëŠ¥ë“¤ì„ ì¡°í•©',
                        variables: 'ì˜ë¯¸ìˆëŠ” ë³€ìˆ˜ëª…ê³¼ ì•½ê°„ì˜ ë³µì¡ì„±',
                        logic: '2-3ê°œì˜ ê°œë…ì„ ì¡°í•©í•œ ì‹¤ìš©ì  ë¬¸ì œ'
                    },
                    'ê³ ê¸‰': {
                        description: 'í”„ë¡œê·¸ë˜ë¨¸/ëŒ€íšŒ ì¤€ë¹„ ìˆ˜ì¤€ (ê³ ê¸‰ ê¸°ë²•ê³¼ ìµœì í™”ë¥¼ ê³ ë ¤í•˜ëŠ” ë‹¨ê³„)',
                        complexity: 'ë³µì¡í•œ ë¡œì§, íš¨ìœ¨ì„±ê³¼ ìµœì í™” ê³ ë ¤',
                        concepts: 'ì„ íƒëœ ì£¼ì œì˜ ê³ ê¸‰ ê¸°ë²•ê³¼ íŠ¸ë¦­ë“¤',
                        variables: 'íš¨ìœ¨ì ì´ê³  ì „ë¬¸ì ì¸ ë³€ìˆ˜ëª…',
                        logic: 'ë³µí•©ì  ì‚¬ê³ ê°€ í•„ìš”í•œ ë„ì „ì  ë¬¸ì œ'
                    }
                };
                
                const currentSpec = difficultySpecs[difficulty];
                
                prompt = `**ì‹œë“œ: ${randomSeed}**

${difficulty} ë‚œì´ë„ì˜ ì™„ì „íˆ ìƒˆë¡œìš´ íŒŒì´ì¬ ë¬¸ì œë¥¼ ìƒì„±í•˜ì„¸ìš”.

**ë‚œì´ë„ ì •ì˜:**
- **${difficulty}**: ${currentSpec.description}
- **ë³µì¡ë„**: ${currentSpec.complexity}
- **ê°œë… ì‚¬ìš©**: ${currentSpec.concepts}
- **ë³€ìˆ˜ ìŠ¤íƒ€ì¼**: ${currentSpec.variables}
- **ë¬¸ì œ íŠ¹ì„±**: ${currentSpec.logic}

**ì„ íƒëœ í•™ìŠµ ì£¼ì œ: ${topics.join(', ')}**
**í—ˆìš©ë˜ëŠ” ëª¨ë“  ê°œë…: ${allowedConcepts.join(', ')} (ì´ì „ ë‹¨ê³„ í¬í•¨)**
**ë¬¸ì œ ë°©í–¥ì„±**: ${randomDirection}
**ìƒí™© í‚¤ì›Œë“œ**: ${randomContext}, ${randomScenario}, ${randomDataType}

**ì—„ê²©í•œ ì£¼ì œ ë° ë‚œì´ë„ ê·œì¹™:**

1. **ì£¼ì œ ì œí•œ (ë§¤ìš° ì¤‘ìš”)**:
   - ì£¼ìš” ì´ˆì : ${topics.join(', ')} (ì„ íƒëœ ì£¼ì œì— 80% ì´ìƒ ì§‘ì¤‘)
   - í—ˆìš© ê°œë…: ${allowedConcepts.join(', ')} (í•™ìŠµ ë‹¨ê³„ìƒ ì´ì „ì— ë°°ìš´ ê²ƒë“¤)
   - ì ˆëŒ€ ê¸ˆì§€: ${learningHierarchy.slice(maxTopicLevel + 1).join(', ')} (ì•„ì§ ë°°ìš°ì§€ ì•Šì€ ê°œë…ë“¤)

2. **ë‚œì´ë„ë³„ ì„¸ë¶€ ìš”êµ¬ì‚¬í•­**:
   
   **ì´ˆê¸‰ (ì…ë¬¸ì)**:
   - í•œ ë²ˆì— í•˜ë‚˜ì˜ ì£¼ìš” ê°œë…ë§Œ ë‹¤ë£¨ê¸°
   - ê°€ì¥ ê¸°ë³¸ì ì¸ ë¬¸ë²•ë§Œ ì‚¬ìš©
   - 5-10ì¤„ ë‚´ì˜ ë‹¨ìˆœí•œ ì½”ë“œ
   - ì§ê´€ì ìœ¼ë¡œ ì´í•´ ê°€ëŠ¥í•œ ë¬¸ì œ
   
   **ì¤‘ê¸‰ (êµì¬ 1~3íšŒë…)**:
   - 2-3ê°œ ê°œë…ì„ ì¡°í•©í•œ ë¬¸ì œ
   - ì•½ê°„ì˜ ë…¼ë¦¬ì  ì‚¬ê³ ê°€ í•„ìš”
   - 10-20ì¤„ ì •ë„ì˜ ì½”ë“œ
   - ì‹¤ìƒí™œ ì‘ìš© ê°€ëŠ¥í•œ ë¬¸ì œ
   
   **ê³ ê¸‰ (í”„ë¡œê·¸ë˜ë¨¸/ëŒ€íšŒ ì¤€ë¹„)**:
   - ë³µí•©ì  ì‚¬ê³ ê°€ í•„ìš”í•œ ë¬¸ì œ
   - íš¨ìœ¨ì„±ê³¼ ìµœì í™” ê³ ë ¤
   - 20ì¤„ ì´ìƒì˜ ë³µì¡í•œ ë¡œì§
   - ë„ì „ì ì´ê³  ì°½ì˜ì  ë¬¸ì œ

**ì½”ë“œ ë ˆë²¨ë³„ ìš”êµ¬ì‚¬í•­:**

1. **ì´ˆë³´ì ì½”ë“œ (answer_beginner)**:
   - ${difficulty} ìˆ˜ì¤€ì— ë§ëŠ” ê°€ì¥ ì§ê´€ì ì¸ í•´ê²°ë°©ì‹
   - ì„ íƒëœ ì£¼ì œì˜ ê¸°ë³¸ ê°œë…ë§Œ ì‚¬ìš©
   - ëª…í™•í•˜ê³  ì½ê¸° ì‰¬ìš´ ì½”ë“œ
   - ë³µì¡í•œ ê¸°ë²• ì‚¬ìš© ê¸ˆì§€

2. **ìˆ™ë ¨ì ì½”ë“œ (answer_expert)**:
   - ${difficulty} ìˆ˜ì¤€ì—ì„œ ê°€ëŠ¥í•œ ìµœì í™”ëœ ì½”ë“œ
   - í—ˆìš©ëœ ê°œë… ë²”ìœ„ ë‚´ì—ì„œ ìµœê³  ìˆ˜ì¤€ì˜ ê¸°ë²• í™œìš©
   - íŒŒì´ì¬ë‹¤ìš´ ìŠ¤íƒ€ì¼ê³¼ íš¨ìœ¨ì„± ëª¨ë‘ ê³ ë ¤
   - ì´ˆë³´ì ì½”ë“œë³´ë‹¤ ëª…í™•íˆ ìš°ìˆ˜í•œ ì ‘ê·¼ë²•

**ë¬¸ì œ ìƒì„± ì²´í¬ë¦¬ìŠ¤íŠ¸:**
1. âœ… ì„ íƒëœ ì£¼ì œ(${topics.join(', ')})ê°€ ë¬¸ì œì˜ í•µì‹¬ì¸ê°€?
2. âœ… ${difficulty} ìˆ˜ì¤€ì— ì í•©í•œ ë³µì¡ë„ì¸ê°€?
3. âœ… í—ˆìš©ë˜ì§€ ì•Šì€ ê°œë…(${learningHierarchy.slice(maxTopicLevel + 1).join(', ')})ì„ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ëŠ”ê°€?
4. âœ… ë‘ ì½”ë“œì˜ ìˆ˜ì¤€ ì°¨ì´ê°€ í•™ìŠµì— ë„ì›€ì´ ë˜ëŠ”ê°€?
5. âœ… ${randomContext} ìƒí™©ì˜ ${randomScenario} ë¬¸ì œë¡œ êµ¬ì„±ë˜ì—ˆëŠ”ê°€?

ë‹¤ìŒ JSONìœ¼ë¡œë§Œ ì‘ë‹µ:
{"id": "${randomSeed}", "category": "${topics[0]}", "title": "ë¬¸ì œ ì œëª©", "description": "ìƒì„¸í•œ ë¬¸ì œ ì„¤ëª… (ë§ˆí¬ë‹¤ìš´)", "answer_beginner": "ì´ˆë³´ì ì½”ë“œ", "answer_expert": "ê³ ê¸‰ ì½”ë“œ"}

ëª¨ë“  í…ìŠ¤íŠ¸ëŠ” í•œê¸€ë¡œ, JSON ë‚´ ì¤„ë°”ê¿ˆì€ \\nìœ¼ë¡œ ì´ìŠ¤ì¼€ì´í”„í•˜ì„¸ìš”.`;
            }

            try {
                console.log("=== API ìš”ì²­ ì¤€ë¹„ ===");
                console.log("ìƒì„±ëœ í”„ë¡¬í”„íŠ¸:", prompt);
                
                let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                const payload = { contents: chatHistory };
                const apiUrl = window.APP_CONFIG.GEMINI_API_URL;
                
                console.log("=== API ìš”ì²­ ì‹¤í–‰ ===");
                console.log("API URL:", apiUrl);
                console.log("ìš”ì²­ í˜ì´ë¡œë“œ:", JSON.stringify(payload, null, 2));
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                console.log("API ì‘ë‹µ ìƒíƒœ:", response.status, response.statusText);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error("API ì‘ë‹µ ì˜¤ë¥˜:", errorText);
                    throw new Error(`API request failed: ${response.status} ${response.statusText} - ${errorText}`);
                }
                
                const result = await response.json();
                console.log("API ì‘ë‹µ ë°ì´í„°:", result);
                
                if (result.candidates && result.candidates.length > 0) {
                    const rawText = result.candidates[0].content.parts[0].text;
                    console.log("ì›ë³¸ AI ì‘ë‹µ:", rawText);
                    
                    const jsonText = rawText.replace(/```json/g, '').replace(/```/g, '').trim();
                    console.log("ì •ì œëœ JSON í…ìŠ¤íŠ¸:", jsonText);
                    
                    try {
                        const newQuiz = JSON.parse(jsonText);
                        console.log("íŒŒì‹±ëœ í€´ì¦ˆ ë°ì´í„°:", newQuiz);
                        updateUIWithNewQuiz(newQuiz);
                    } catch (parseError) {
                        console.error("JSON íŒŒì‹± ì˜¤ë¥˜:", parseError);
                        console.error("íŒŒì‹± ì‹¤íŒ¨í•œ í…ìŠ¤íŠ¸:", jsonText);
                        throw new Error("AI ì‘ë‹µì„ JSONìœ¼ë¡œ íŒŒì‹±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤: " + parseError.message);
                    }
                } else {
                    console.error("ìœ íš¨í•œ candidatesê°€ ì—†ìŒ:", result);
                    throw new Error("APIì—ì„œ ìœ íš¨í•œ ì‘ë‹µì„ ë°›ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");
                }

            } catch (error) {
                console.error("Custom Quiz Generation Error:", error);
                console.error("Error details:", {
                    message: error.message,
                    stack: error.stack,
                    topics: topics,
                    difficulty: difficulty
                });
                
                // ë” êµ¬ì²´ì ì¸ ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
                let errorMsg = "AI ë¬¸ì œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
                if (error.message.includes('429')) {
                    errorMsg = "ì˜¤ëŠ˜ì˜ API ì‚¬ìš©ëŸ‰ì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. ë‚´ì¼ ë‹¤ì‹œ ì‹œë„í•˜ê±°ë‚˜ ìƒˆë¡œìš´ API í‚¤ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.";
                } else if (error.message.includes('fetch')) {
                    errorMsg = "ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.";
                } else if (error.message.includes('JSON')) {
                    errorMsg = "AI ì‘ë‹µ í˜•ì‹ì— ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
                } else if (error.message.includes('500')) {
                    errorMsg = "ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
                }
                showAlert(errorMsg);
            } finally {
                generateBtnText.textContent = "AIë¡œ ë¬¸ì œ ìƒì„±í•˜ê¸°";
                generateSpinner.classList.add('hidden');
                generateQuizBtn.disabled = false;
            }
        }
        
        // ë©”ì¸ ë¬¸ì œ ìƒì„± í•¨ìˆ˜
        function handleGenerateQuiz() {
            console.log("=== ë¬¸ì œ ìƒì„± ì‹œì‘ ===");
            const selectedDifficulty = document.querySelector('input[name="difficulty"]:checked').value;
            const selectedCategories = Array.from(document.querySelectorAll('#topic-selection input:checked')).map(cb => cb.value);
            
            console.log("ì„ íƒëœ ë‚œì´ë„:", selectedDifficulty);
            console.log("ì„ íƒëœ ì¹´í…Œê³ ë¦¬:", selectedCategories);
            
            if (etcCheckbox.checked) {
                const customTopic = customTopicInput.value.trim();
                if (customTopic) {
                    selectedCategories.push(customTopic);
                } else {
                    showAlert("'ê¸°íƒ€' ì£¼ì œë¥¼ ì§ì ‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    return;
                }
            }
            
            if (selectedCategories.length === 0) {
                showAlert("í•™ìŠµí•  ì£¼ì œë¥¼ í•˜ë‚˜ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.");
                return;
            }
            
            // Netlify Functions ì—”ë“œí¬ì¸íŠ¸ í™•ì¸
            console.log("API URL:", window.APP_CONFIG?.GEMINI_API_URL);
            
            fetchAIQuiz(selectedCategories, selectedDifficulty);
        }

        // ëª¨ë‹¬ìš© AI ì„¤ëª… í•¨ìˆ˜
        async function getAIExplanation(prompt) {
            const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
            const payload = { contents: chatHistory };
            const apiUrl = window.APP_CONFIG.GEMINI_API_URL;
            
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) {
                throw new Error(`API request failed: ${response.statusText}`);
            }

            const result = await response.json();
            
            if (result.candidates && result.candidates.length > 0) {
                return result.candidates[0].content.parts[0].text;
            } else {
                throw new Error("Invalid API response");
            }
        }

        // ë²”ìš© AI í”¼ë“œë°± í•¨ìˆ˜
        async function getAIFeedback(prompt, button, buttonText, spinner, outputElement) {
            const userCode = userCodeInput.value.trim();
            if (!userCode && (button === aiCoachBtn || button === optimizeCodeBtn)) {
                showAlert("ì½”ë“œë¥¼ ë¨¼ì € ì‘ì„±í•´ì£¼ì„¸ìš”.");
                return;
            }
            if (!currentQuiz) {
                 showAlert("ë¨¼ì € ë¬¸ì œë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.");
                return;
            }

            button.disabled = true;
            const originalText = buttonText ? buttonText.textContent : button.textContent;
            if (buttonText) {
                buttonText.textContent = "AI ë¶„ì„ ì¤‘...";
            } else {
                button.textContent = "AI ë¶„ì„ ì¤‘...";
            }
            if (spinner) spinner.classList.remove('hidden');
            outputElement.classList.add('hidden');

            try {
                 let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                 const payload = { contents: chatHistory };
                 const apiUrl = window.APP_CONFIG.GEMINI_API_URL;
                 
                 const response = await fetch(apiUrl, {
                     method: 'POST',
                     headers: { 'Content-Type': 'application/json' },
                     body: JSON.stringify(payload)
                 });

                if (!response.ok) throw new Error(`API request failed: ${response.statusText}`);

                 const result = await response.json();
                 
                 if (result.candidates && result.candidates.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    outputElement.innerHTML = marked.parse(text, { 
                        sanitize: false,
                        gfm: true,
                        breaks: true
                    });
                 } else {
                    throw new Error("Invalid API response.");
                 }

            } catch (error) {
                console.error("AI Feedback Error:", error);
                showAlert("AI ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
                outputElement.innerHTML = '';
            } finally {
                button.disabled = false;
                if (buttonText) {
                    buttonText.textContent = originalText;
                } else {
                    button.textContent = originalText;
                }
                if (spinner) spinner.classList.add('hidden');
                if (outputElement.innerHTML) {
                    outputElement.classList.remove('hidden');
                }
            }
        }

        // ëª¨ë²” ë‹µì•ˆ í‘œì‹œ/ìˆ¨ê¸°ê¸°
        function toggleAnswer() {
            if (!currentQuiz) {
                showAlert("ë¨¼ì € ë¬¸ì œë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.");
                return;
            }
            
            const isHidden = answerContainer.classList.toggle('hidden');
            if (!isHidden) {
                if (currentQuiz.inefficient_code) { // ë¦¬íŒ©í† ë§ ì±Œë¦°ì§€
                    beginnerAnswerTitle.textContent = 'ğŸ§‘â€ğŸ’» ê°œì„  ì „ ì½”ë“œ';
                    answerCodeBeginner.textContent = currentQuiz.inefficient_code;
                    expertAnswerTitle.textContent = 'ğŸš€ ê°œì„  í›„ ì½”ë“œ (ëª¨ë²” ë‹µì•ˆ)';
                    answerCodeExpert.textContent = currentQuiz.refactored_code;
                } else { // ì¼ë°˜ ë¬¸ì œ
                    beginnerAnswerTitle.textContent = 'ğŸ§‘â€  ì´ˆë³´ììš© í’€ì´';
                    answerCodeBeginner.textContent = currentQuiz.answer_beginner;
                    expertAnswerTitle.textContent = 'ğŸš€ ìˆ™ë ¨ììš© í’€ì´';
                    answerCodeExpert.textContent = currentQuiz.answer_expert;
                }

                hljs.highlightElement(answerCodeBeginner);
                hljs.highlightElement(answerCodeExpert);
                showAnswerBtn.textContent = "ë‹µì•ˆ ìˆ¨ê¸°ê¸°";

            } else {
                showAnswerBtn.textContent = "ëª¨ë²” ë‹µì•ˆ ë³´ê¸°";
            }
        }
        
        // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë° ì´ˆê¸°í™” ---
        populateTopics();
        
        generateQuizBtn.addEventListener('click', handleGenerateQuiz);
        etcCheckbox.addEventListener('change', () => {
            customTopicInput.disabled = !etcCheckbox.checked;
            if (etcCheckbox.checked) {
                customTopicInput.focus();
            }
        });

        aiCoachBtn.addEventListener('click', () => {
            const prompt = `You are a friendly Python coding tutor. A student is solving the following problem: "${currentQuiz.description}". The student's code is: \`\`\`python\n${userCodeInput.value}\n\`\`\` Please provide hints without giving away the answer. Point out errors, suggest better approaches, or praise good parts. Use Korean with a friendly tone. **Format your response in Markdown.** Never show the complete answer code.`;
            getAIFeedback(prompt, aiCoachBtn, coachBtnText, coachSpinner, aiFeedback);
        });

        optimizeCodeBtn.addEventListener('click', () => {
            const prompt = `You are an expert Python code optimizer. Analyze the following Python code in the context of the problem: "${currentQuiz.description}". The student's code is: \`\`\`python\n${userCodeInput.value}\n\`\`\` Provide specific suggestions to improve its performance (time complexity, space complexity) and make it more Pythonic. Explain why your suggestions are better. Use Korean with a professional but easy-to-understand tone. **Format your response in Markdown.**`;
            getAIFeedback(prompt, optimizeCodeBtn, optimizeBtnText, optimizeSpinner, aiFeedback);
        });

        explainBeginnerBtn.addEventListener('click', async () => {
            const code = currentQuiz.inefficient_code || currentQuiz.answer_beginner;
            const title = currentQuiz.inefficient_code ? 'ğŸ§‘â€ğŸ’» ê°œì„  ì „ ì½”ë“œ ì„¤ëª…' : 'ğŸ§‘â€ğŸ’» ì´ˆë³´ììš© í’€ì´ ì„¤ëª…';
            const problemDescription = currentQuiz.description;
            
            showExplanationModal(title, true, 'beginner');
            
            const prompt = `ë‹¤ìŒì€ íŒŒì´ì¬ ì´ˆë³´ìë¥¼ ìœ„í•œ ì½”ë“œ ì„¤ëª…ì…ë‹ˆë‹¤. ë§¤ìš° ìì„¸í•˜ê³  ì¹œì ˆí•˜ê²Œ ì„¤ëª…í•´ì£¼ì„¸ìš”.

**ë¬¸ì œ:**
${problemDescription}

**ì´ˆë³´ììš© ì½”ë“œ:**
\`\`\`python
${code}
\`\`\`

ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¡œ ì´ˆë³´ìê°€ ì´í•´í•˜ê¸° ì‰½ê²Œ ì„¤ëª…í•´ì£¼ì„¸ìš”:

## ğŸ¯ ë¬¸ì œ ì´í•´í•˜ê¸°
- ì´ ë¬¸ì œê°€ ë¬´ì—‡ì„ ìš”êµ¬í•˜ëŠ”ì§€ ì‰¬ìš´ ë§ë¡œ ì„¤ëª…
- ì…ë ¥ê³¼ ì¶œë ¥ì´ ë¬´ì—‡ì¸ì§€ ëª…í™•íˆ ì„¤ëª…

## ğŸ“ í•´ê²° ì „ëµ
- ë¬¸ì œë¥¼ ì–´ë–»ê²Œ ë‹¨ê³„ë³„ë¡œ ì ‘ê·¼í–ˆëŠ”ì§€
- ì™œ ì´ëŸ° ë°©ì‹ìœ¼ë¡œ í•´ê²°í–ˆëŠ”ì§€ ì´ìœ  ì„¤ëª…

## ğŸ” ì½”ë“œ í•œ ì¤„ì”© ë¶„ì„
ì½”ë“œì˜ ê° ì¤„ì„ ë‹¤ìŒê³¼ ê°™ì´ ë¶„ì„í•´ì£¼ì„¸ìš”:
- **ê° ì¤„ì´ í•˜ëŠ” ì¼**: êµ¬ì²´ì ìœ¼ë¡œ ë¬´ì—‡ì„ í•˜ëŠ”ì§€
- **ì™œ í•„ìš”í•œì§€**: ì´ ì¤„ì´ ì™œ í•„ìš”í•œì§€ ì´ìœ  ì„¤ëª…
- **ë³€ìˆ˜ì˜ ì—­í• **: ì‚¬ìš©ëœ ë³€ìˆ˜ê°€ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ”ì§€
- **ì£¼ì˜ì‚¬í•­**: ì´ˆë³´ìê°€ ë†“ì¹˜ê¸° ì‰¬ìš´ ë¶€ë¶„ì´ë‚˜ ì£¼ì˜í•  ì 

## ğŸ’¡ í•µì‹¬ ê°œë… ì„¤ëª…
- ì´ ì½”ë“œì—ì„œ ì‚¬ìš©ëœ íŒŒì´ì¬ ê¸°ë³¸ ê°œë…ë“¤ (ë°˜ë³µë¬¸, ì¡°ê±´ë¬¸, í•¨ìˆ˜, ë¦¬ìŠ¤íŠ¸ ë“±)
- ê° ê°œë…ì´ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ì´ˆë³´ì ìˆ˜ì¤€ì—ì„œ ì„¤ëª…
- ë¹„ìŠ·í•œ ìƒí™©ì—ì„œ ì–´ë–»ê²Œ ì‘ìš©í•  ìˆ˜ ìˆëŠ”ì§€

## ğŸš€ ì‹¤í–‰ ê³¼ì • ì‹œë®¬ë ˆì´ì…˜
- ì˜ˆì‹œ ì…ë ¥ì„ ì‚¬ìš©í•´ì„œ ì½”ë“œê°€ ì–´ë–»ê²Œ ì‹¤í–‰ë˜ëŠ”ì§€ ë‹¨ê³„ë³„ë¡œ ì¶”ì 
- ê° ë‹¨ê³„ì—ì„œ ë³€ìˆ˜ ê°’ì´ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ ë³´ì—¬ì£¼ê¸°
- ìµœì¢… ê²°ê³¼ê°€ ì–´ë–»ê²Œ ë‚˜ì˜¤ëŠ”ì§€ ì„¤ëª…

## ğŸ¤” ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜ì™€ í•´ê²°ë²•
- ì´ˆë³´ìê°€ ì´ëŸ° ë¬¸ì œì—ì„œ ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜ë“¤
- ë””ë²„ê¹… íŒê³¼ ë¬¸ì œ í•´ê²° ë°©ë²•
- ì½”ë“œë¥¼ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•

## ğŸ“š ì¶”ê°€ í•™ìŠµ í¬ì¸íŠ¸
- ì´ ë¬¸ì œë¥¼ í†µí•´ ë°°ìš¸ ìˆ˜ ìˆëŠ” ê²ƒë“¤
- ê´€ë ¨ëœ ë‹¤ë¥¸ ê°œë…ë“¤
- ë‹¤ìŒì— ë„ì „í•´ë³¼ ë§Œí•œ ë¹„ìŠ·í•œ ë¬¸ì œë“¤

í•œê¸€ë¡œ ì‘ì„±í•˜ê³ , ì´ˆë³´ìë„ ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì¹œê·¼í•˜ê³  ìƒì„¸í•˜ê²Œ ì„¤ëª…í•´ì£¼ì„¸ìš”. ì „ë¬¸ ìš©ì–´ë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” ë°˜ë“œì‹œ ì‰¬ìš´ ë§ë¡œ í’€ì–´ì„œ ì„¤ëª…í•´ì£¼ì„¸ìš”.`;
            
            try {
                const explanation = await getAIExplanation(prompt);
                setExplanationContent(explanation, 'beginner');
            } catch (error) {
                setExplanationContent('âŒ ì„¤ëª…ì„ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 'beginner');
            }
        });

        explainExpertBtn.addEventListener('click', async () => {
            const code = currentQuiz.refactored_code || currentQuiz.answer_expert;
            const beginnerCode = currentQuiz.inefficient_code || currentQuiz.answer_beginner;
            const title = currentQuiz.refactored_code ? 'ğŸš€ ê°œì„  í›„ ì½”ë“œ ì„¤ëª…' : 'ğŸš€ ìˆ™ë ¨ììš© í’€ì´ ì„¤ëª…';
            
            showExplanationModal(title, true, 'expert');
            
            const prompt = `ë‹¤ìŒì€ ê°™ì€ ë¬¸ì œì— ëŒ€í•œ ë‘ ê°€ì§€ í•´ê²°ì±…ì…ë‹ˆë‹¤. ìˆ™ë ¨ììš© ì½”ë“œë¥¼ ì „ë¬¸ê°€ ê´€ì ì—ì„œ ìƒì„¸íˆ ë¶„ì„í•´ì£¼ì„¸ìš”.

**ì´ˆë³´ì/ê°œì„  ì „ ì½”ë“œ:**
\`\`\`python
${beginnerCode}
\`\`\`

**ìˆ™ë ¨ì/ê°œì„  í›„ ì½”ë“œ:**
\`\`\`python
${code}
\`\`\`

ë‹¤ìŒ ê´€ì ì—ì„œ ìˆ™ë ¨ììš© ì½”ë“œë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”:

## ğŸš€ ê³ ê¸‰ ê¸°ë²• ë¶„ì„
- ì‚¬ìš©ëœ íŒŒì´ì¬ ê³ ê¸‰ ê¸°ë²•ë“¤ (ë¦¬ìŠ¤íŠ¸ ì»´í”„ë¦¬í—¨ì…˜, ëŒë‹¤, ë‚´ì¥í•¨ìˆ˜ ë“±)
- ê° ê¸°ë²•ì´ ì„ íƒëœ ì´ìœ ì™€ ì¥ì 

## âš¡ ì„±ëŠ¥ ìµœì í™”
- ì‹œê°„ ë³µì¡ë„ ê°œì„  (Big O ë¶„ì„)
- ê³µê°„ ë³µì¡ë„ ê°œì„ 
- ë©”ëª¨ë¦¬ íš¨ìœ¨ì„± í–¥ìƒ

## ğŸ¯ íŒŒì´ì¬ë‹¤ìš´ ìŠ¤íƒ€ì¼ (Pythonic)
- íŒŒì´ì¬ ê´€ìš©êµ¬ í™œìš©
- ì½”ë“œ ê°€ë…ì„±ê³¼ ê°„ê²°ì„±
- PEP 8 ìŠ¤íƒ€ì¼ ê°€ì´ë“œ ì¤€ìˆ˜

## ğŸ“Š ì´ˆë³´ì ì½”ë“œì™€ì˜ ì°¨ì´ì 
- êµ¬ì²´ì ì¸ ê°œì„  ì‚¬í•­
- ì™œ ì´ ë°©ì‹ì´ ë” ë‚˜ì€ì§€
- ì‹¤ì œ ì„±ëŠ¥ ì°¨ì´ ì˜ˆìƒì¹˜

## ğŸ’¡ í•™ìŠµ í¬ì¸íŠ¸
- ì´ ì½”ë“œì—ì„œ ë°°ìš¸ ìˆ˜ ìˆëŠ” í•µì‹¬ ê°œë…
- ë‹¤ë¥¸ ìƒí™©ì—ì„œ ì‘ìš©í•  ìˆ˜ ìˆëŠ” íŒ¨í„´

í•œê¸€ë¡œ ì‘ì„±í•˜ê³  ë§ˆí¬ë‹¤ìš´ í˜•ì‹ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”. ì „ë¬¸ì ì´ì§€ë§Œ ì´í•´í•˜ê¸° ì‰½ê²Œ ì„¤ëª…í•´ì£¼ì„¸ìš”.`;
            
            try {
                const explanation = await getAIExplanation(prompt);
                setExplanationContent(explanation, 'expert');
            } catch (error) {
                setExplanationContent('âŒ ì„¤ëª…ì„ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 'expert');
            }
        });

        showAnswerBtn.addEventListener('click', toggleAnswer);

    });
    </script>
</body>
</html>